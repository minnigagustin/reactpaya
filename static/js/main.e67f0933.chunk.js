(this.webpackJsonppayatookan=this.webpackJsonppayatookan||[]).push([[0],{260:function(e,t,a){},328:function(e,t){},330:function(e,t){},341:function(e,t){},343:function(e,t){},368:function(e,t){},370:function(e,t){},371:function(e,t){},376:function(e,t){},378:function(e,t){},384:function(e,t){},386:function(e,t){},405:function(e,t){},417:function(e,t){},420:function(e,t){},483:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a.n(n),r=a(43),i=a.n(r),o=(a(260),a(29)),s=a(30),l=a(31),d=a(44),u=a(156),j=a(25),b=a(22),p=a(20),m=a(10),h=a.n(m),f=a(18),O=(a(58),a(16)),x=a.n(O),_=(a(54),a(76)),g=a(77),v=a(498),y=a(491),k=a(492),C=a(493),w=a(494),N=a(495),I=a(496),S=a(0),F=function(e){var t=e.children,a=e.title,n=Object(j.f)();"true"!==localStorage.getItem("authenticated")&&(window.location.href="/");return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("nav",{class:"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0",children:Object(S.jsx)("a",{class:"navbar-brand col-sm-3 col-md-2 mr-0",href:"#",children:"Pay\xe1 Reports"})}),Object(S.jsx)("div",{class:"container-fluid",children:Object(S.jsxs)("div",{class:"row",children:[Object(S.jsx)("nav",{class:"col-md-2 d-none d-md-block bg-light sidebar",children:Object(S.jsx)("div",{class:"sidebar-sticky",children:Object(S.jsxs)("ul",{class:"nav flex-column",children:[Object(S.jsx)("li",{class:"nav-item",children:Object(S.jsxs)("a",{class:"nav-link ".concat("/payatookan"===n.pathname?"active":""),href:"/payatookan",children:[Object(S.jsx)("i",{class:"bi bi-house"})," General"]})}),Object(S.jsx)("li",{class:"nav-item",children:Object(S.jsxs)("a",{class:"nav-link ".concat("/payatookan/panel"===n.pathname?"active":""),href:"/payatookan/panel",children:[Object(S.jsx)("span",{"data-feather":"Layout"}),Object(S.jsx)("i",{class:"bi bi-card-list"})," Panel"]})}),Object(S.jsx)("li",{class:"nav-item",children:Object(S.jsxs)("a",{class:"nav-link ".concat("/payatookan/propina"===n.pathname?"active":""),href:"/payatookan/propina",children:[Object(S.jsx)("i",{class:"bi bi-cash-coin"})," Propinas"]})}),Object(S.jsx)("li",{class:"nav-item",children:Object(S.jsxs)("a",{class:"nav-link ".concat("/payatookan/auto"===n.pathname?"active":""),href:"/payatookan/auto",children:[Object(S.jsx)("span",{"data-feather":"file"}),Object(S.jsx)("i",{class:"bi bi-arrow-clockwise"})," Automatizaci\xf3n"]})}),Object(S.jsx)("li",{class:"nav-item",children:Object(S.jsxs)("a",{class:"nav-link ".concat("/payatookan/envios"===n.pathname?"active":""),href:"/payatookan/envios",children:[Object(S.jsx)("span",{"data-feather":"file"}),Object(S.jsx)("i",{class:"bi bi-bicycle"})," Env\xedos"]})}),Object(S.jsx)("li",{class:"nav-item",children:Object(S.jsxs)("a",{class:"nav-link ".concat("/payatookan/noti"===n.pathname?"active":""),href:"/payatookan/noti",children:[Object(S.jsx)("span",{"data-feather":"file"}),Object(S.jsx)("i",{class:"bi bi-bell"})," Notificaciones"]})})]})})}),Object(S.jsxs)("main",{role:"main",class:"col-md-9 ml-sm-auto col-lg-10 pt-3 px-4",children:[Object(S.jsxs)("div",{class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom",children:[Object(S.jsx)("h1",{class:"h2",children:a}),Object(S.jsx)("ul",{class:"navbar-nav px-3",children:Object(S.jsx)("li",{class:"nav-item text-nowrap",children:Object(S.jsx)("button",{class:"btn btn-secondary",onClick:function(){localStorage.removeItem("authenticated"),window.location.href="/"},children:"SALIR"})})})]}),t]})]})})]})},z="https://api.tookanapp.com/v2/get_all_fleets",D={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06"},M={"Content-Type":"application/json"},E=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={data:[],dataBackup:[],modalInsertar:!1,modalEliminar:!1,total:0,textSearch:"",fecha:{inicial:"",final:""},noti:{id:0,nombre:""},form:{id:"",nombre:"",pais:0,razon:"",razons:"",reference_id:"",tipoModal:"",aurest:2,crediwallet:2,wallettotal:0,total:0}},e.peticionGet=function(){x.a.post(z,D,M).then((function(t){e.setState({data:t.data.data,dataBackup:t.data.data})})).catch((function(e){console.log(e.message)}))},e.peticionPost=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return delete e.state.form.id,t.next=3,x.a.post(z,e.state.form).then((function(t){e.modalInsertar(),e.peticionGet()})).catch((function(e){console.log(e.message)}));case 3:case"end":return t.stop()}}),t)}))),e.peticionPut=function(){var t={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",fleet_id:e.state.form.id,amount:e.state.form.total,transaction_type:e.state.form.aurest,reference_id:e.state.form.reference_id,wallet_type:e.state.form.crediwallet,description:e.state.form.razon};x.a.post("https://api.tookanapp.com/v2/fleet/wallet/create_transaction",t,M).then((function(t){e.modalInsertar(),e.peticionGet()}))},e.peticionDelete=function(){x.a.delete(z+e.state.form.id).then((function(t){e.setState({modalEliminar:!1}),e.peticionGet()}))},e.modalInsertar=function(){e.setState({modalInsertar:!e.state.modalInsertar})},e.seleccionarEmpresa=function(t){e.setState({tipoModal:"actualizar",form:{id:t.fleet_id,nombre:t.name,pais:"Cargando...",aurest:2,crediwallet:2,wallettotal:"Cargando...",capital_bursatil:t.pais}});var a={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",fleet_id:t.fleet_id,wallet_type:2,starting_date:"2019-06-21",ending_date:"2023-06-21"};x.a.post("https://api.tookanapp.com/v2/fleet/wallet/read_transaction_history",a,M).then((function(a){if(1===a.data.data.wallet_balance[0].wallet_type)var n=a.data.data.wallet_balance[0].wallet_balance;else n="Cargando...";e.setState({tipoModal:"actualizar",form:{id:t.fleet_id,nombre:t.name,pais:a.data.data.wallet_balance[a.data.data.wallet_balance.length-1].wallet_balance,aurest:2,crediwallet:2,wallettotal:n,capital_bursatil:t.pais}})})).catch((function(e){console.log(e.message)}))},e.handleChangeFecha=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState({fecha:Object(p.a)(Object(p.a)({},e.state.fecha),{},Object(b.a)({},a.target.name,a.target.value))});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState({form:Object(p.a)(Object(p.a)({},e.state.form),{},Object(b.a)({},a.target.name,a.target.value))});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChangeNoti=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState(Object(b.a)({},a.target.name,a.target.value));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.seleccionarNoti=function(t){e.setState({total:0,noti:{id:t.fleet_id,nombre:t.name},modalEliminar:!e.state.modalEliminar})},e.EnviarNoti=function(){var t=[];t.push(e.state.noti.id);var a={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",fleet_ids:t,message:"Hola "+e.state.noti.nombre+", hemos realizado una transferencia a tu cuenta por $"+e.state.total};x.a.post("https://api.tookanapp.com/v2/send_notification",a,M).then((function(t){console.log(t.data),e.setState({modalEliminar:!e.state.modalEliminar})}))},e.onChangeSearch=function(){var t=Object(f.a)(h.a.mark((function t(a){var n,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.persist(),n=e.state.dataBackup,c=n.filter((function(e){var t=e.name.toUpperCase(),n=a.target.value.toUpperCase();return t.indexOf(n)>-1})),e.setState({data:c});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.peticionGet()}},{key:"render",value:function(){var e=this,t=this.state.form;return Object(S.jsxs)(F,{title:"General",children:[Object(S.jsx)("input",{placeholder:"Buscar...",onChange:this.onChangeSearch}),Object(S.jsxs)("table",{className:"table ",children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{children:"ID"}),Object(S.jsx)("th",{children:"Nombre"}),Object(S.jsx)("th",{children:"Acciones"})]})}),Object(S.jsx)("tbody",{children:this.state.data.map((function(t){return Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{children:t.fleet_id}),Object(S.jsx)("td",{children:t.name}),Object(S.jsxs)("td",{children:[Object(S.jsx)("button",{className:"btn btn-primary",onClick:function(){e.seleccionarEmpresa(t),e.modalInsertar()},children:Object(S.jsx)(_.a,{icon:g.a})}),"|",Object(S.jsx)("button",{className:"btn btn-success",onClick:function(){e.seleccionarNoti(t)},children:"N"})]})]})}))})]}),Object(S.jsxs)(v.a,{isOpen:this.state.modalInsertar,centered:!0,children:[Object(S.jsx)(y.a,{style:{display:"block"},children:Object(S.jsx)("span",{style:{float:"right"},onClick:function(){return e.modalInsertar()},children:"x"})}),Object(S.jsx)(k.a,{children:Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"id",children:"ID"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"id",id:"id",readOnly:!0,onChange:this.handleChange,value:t?t.id:this.state.data.length+1}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Nombre"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"nombre",id:"nombre",readOnly:!0,onChange:this.handleChange,value:t?t.nombre:""}),Object(S.jsx)("br",{}),Object(S.jsxs)(C.a,{children:[Object(S.jsxs)(w.a,{children:[Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Wallet"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"wallettotal",id:"wallettotal",readOnly:!0,onChange:this.handleChange,value:"Cargando..."!==t.wallettotal?"$"+t.wallettotal.toFixed(2):t.wallettotal})]}),Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Credito"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"pais",id:"pais",readOnly:!0,onChange:this.handleChange,value:"Cargando..."!==t.pais?"$"+t.pais.toFixed(2):t.pais})]})]}),Object(S.jsx)("br",{}),Object(S.jsxs)("select",{className:"form-control",name:"crediwallet",id:"crediwallet",onChange:this.handleChange,children:[Object(S.jsx)("option",{value:"2",children:"Credito"}),Object(S.jsx)("option",{value:"1",children:"Wallet"})]}),Object(S.jsx)("br",{}),Object(S.jsxs)(w.a,{children:[Object(S.jsx)(N.a,{children:Object(S.jsxs)("select",{className:"form-control",name:"aurest",id:"aurest",onChange:this.handleChange,children:[Object(S.jsx)("option",{value:"2",children:"Aumentar"}),Object(S.jsx)("option",{value:"1",children:"Restar"})]})}),Object(S.jsx)(N.a,{children:Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"total",id:"total",onChange:this.handleChange,value:t?t.capital_bursatil:""})})]})]}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Razon"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"razon",id:"razon",onChange:this.handleChange,value:t?t.razon:""}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Task ID"}),Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"reference_id",id:"reference_id",onChange:this.handleChange,value:t?t.razons:""})]})}),Object(S.jsxs)(I.a,{children:["insertar"===this.state.tipoModal?Object(S.jsx)("button",{className:"btn btn-success",onClick:function(){return e.peticionPost()},children:"Insertar"}):Object(S.jsx)("button",{className:"btn btn-primary",onClick:function(){return e.peticionPut()},children:"Actualizar"}),Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.modalInsertar()},children:"Cancelar"})]})]}),Object(S.jsxs)(v.a,{isOpen:this.state.modalEliminar,centered:!0,children:[Object(S.jsx)(k.a,{children:Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsxs)("label",{htmlFor:"nombre",children:["Monto depositado a ",this.state.noti.nombre]}),Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"total",id:"total",onChange:this.handleChangeNoti,value:this.state.total?this.state.total:""})]})}),Object(S.jsxs)(I.a,{children:[Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.setState({modalEliminar:!1})},children:"Salir"}),Object(S.jsx)("button",{className:"btn btn-success",onClick:function(){return e.EnviarNoti()},children:"Notificacion"})]})]})]})}}]),a}(n.Component),A="https://api.tookanapp.com/v2/get_fare_estimate",P={"Content-Type":"application/json"},Y=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={data:{id:"",envio:0,distancia:0,tiempo:0},id:0,job_latitude:0,job_longitude:0,job_pickup_latitude:0,job_pickup_longitude:0,job_pickup_address:"",job_address:"",modalInsertar:!1,modalEliminar:!1,fecha:{inicial:"",final:""},form:{id:"",nombre:"",pais:0,razon:"",razons:"",reference_id:"",tipoModal:"",aurest:2,crediwallet:2,wallettotal:0,total:0}},e.peticionGet=function(){var t={template_name:"Order_Details",delivery_latitude:e.state.job_latitude,delivery_longitude:e.state.job_longitude,api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",pickup_latitude:e.state.job_pickup_latitude,pickup_longitude:e.state.job_pickup_longitude,formula_type:1,map_keys:{map_plan_type:1,google_api_key:"AIzaSyDVkVjap_CH32oy6A3V6T_ewq9jIq8q5eY"}};x.a.post(A,t,P).then((function(t){e.setState({data:{envio:t.data.data.estimated_fare,distancia:t.data.data.distance/1e3,tiempo:t.data.data.time/60}})})).catch((function(e){console.log(e.message)}))},e.peticionPost=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return delete e.state.form.id,t.next=3,x.a.post(A,e.state.form).then((function(t){e.modalInsertar(),e.peticionGet()})).catch((function(e){console.log(e.message)}));case 3:case"end":return t.stop()}}),t)}))),e.peticionPut=function(){e.setState({data:{envio:"Cargando...",distancia:"Cargando...",tiempo:"Cargando..."}});var t={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",job_ids:[e.state.id],include_task_history:0};x.a.post("https://api.tookanapp.com/v2/get_job_details",t,P).then((function(t){console.log(t.data.data[0]),e.setState({job_latitude:t.data.data[0].job_latitude,job_longitude:t.data.data[0].job_longitude,job_pickup_latitude:t.data.data[0].job_pickup_latitude,job_pickup_longitude:t.data.data[0].job_pickup_longitude,job_pickup_address:t.data.data[0].job_pickup_address,job_address:t.data.data[0].job_address}),e.peticionGet()}))},e.peticionDelete=function(){x.a.delete(A+e.state.form.id).then((function(t){e.setState({modalEliminar:!1}),e.peticionGet()}))},e.modalInsertar=function(){e.setState({modalInsertar:!e.state.modalInsertar})},e.seleccionarEmpresa=function(t){e.setState({tipoModal:"actualizar",form:{id:t.fleet_id,nombre:t.name,pais:"Cargando...",aurest:2,crediwallet:2,wallettotal:"Cargando...",capital_bursatil:t.pais}});var a={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",fleet_id:t.fleet_id,wallet_type:2,starting_date:"2019-06-21",ending_date:"2023-06-21"};x.a.post("https://api.tookanapp.com/v2/fleet/wallet/read_transaction_history",a,P).then((function(a){if(1===a.data.data.wallet_balance[0].wallet_type)var n=a.data.data.wallet_balance[0].wallet_balance;else n="Cargando...";e.setState({tipoModal:"actualizar",form:{id:t.fleet_id,nombre:t.name,pais:a.data.data.wallet_balance[a.data.data.wallet_balance.length-1].wallet_balance,aurest:2,crediwallet:2,wallettotal:n,capital_bursatil:t.pais}})})).catch((function(e){console.log(e.message)}))},e.handleChangeFecha=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState({fecha:Object(p.a)(Object(p.a)({},e.state.fecha),{},Object(b.a)({},a.target.name,a.target.value))});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState({id:a.target.value});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.form,n=t.data;return Object(S.jsxs)(F,{title:"Env\xedos",children:[Object(S.jsx)("input",{placeholder:"Pedido N\xb0...",onChange:this.handleChange}),Object(S.jsx)("button",{className:"btn btn-primary",onClick:function(){return e.peticionPut()},children:Object(S.jsx)(_.a,{icon:g.b})}),Object(S.jsx)("br",{}),this.state.job_pickup_address," | ",this.state.job_address,Object(S.jsxs)("table",{className:"table ",children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{children:"Tiempo"}),Object(S.jsx)("th",{children:"Distancia"}),Object(S.jsx)("th",{children:"Total"})]})}),Object(S.jsxs)("tbody",{children:[Object(S.jsx)("td",{children:"Cargando..."!==n.tiempo?n.tiempo.toFixed(2)+"Min":n.tiempo}),Object(S.jsx)("td",{children:"Cargando..."!==n.distancia?n.distancia.toFixed(2)+"Km":n.distancia}),Object(S.jsx)("td",{children:"Cargando..."!==n.envio?"$"+n.envio:n.envio})]})]}),Object(S.jsx)("button",{className:"btn btn-success",style:{width:"98%"},onClick:function(){return e.peticionPost()},children:"Actualizar | Pronto"}),Object(S.jsxs)(v.a,{isOpen:this.state.modalInsertar,centered:!0,children:[Object(S.jsx)(y.a,{style:{display:"block"},children:Object(S.jsx)("span",{style:{float:"right"},onClick:function(){return e.modalInsertar()},children:"x"})}),Object(S.jsx)(k.a,{children:Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"id",children:"ID"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"id",id:"id",readOnly:!0,onChange:this.handleChange,value:a?a.id:this.state.data.length+1}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Distancia"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"nombre",id:"nombre",readOnly:!0,onChange:this.handleChange,value:a?a.nombre:""}),Object(S.jsx)("br",{}),Object(S.jsxs)(C.a,{children:[Object(S.jsxs)(w.a,{children:[Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Wallet"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"wallettotal",id:"wallettotal",readOnly:!0,onChange:this.handleChange,value:"Cargando..."!==a.wallettotal?"$"+a.wallettotal.toFixed(2):a.wallettotal})]}),Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Credito"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"pais",id:"pais",readOnly:!0,onChange:this.handleChange,value:"Cargando..."!==a.pais?"$"+a.pais.toFixed(2):a.pais})]})]}),Object(S.jsx)("br",{}),Object(S.jsxs)("select",{className:"form-control",name:"crediwallet",id:"crediwallet",onChange:this.handleChange,children:[Object(S.jsx)("option",{value:"2",children:"Credito"}),Object(S.jsx)("option",{value:"1",children:"Wallet"})]}),Object(S.jsx)("br",{}),Object(S.jsxs)(w.a,{children:[Object(S.jsx)(N.a,{children:Object(S.jsxs)("select",{className:"form-control",name:"aurest",id:"aurest",onChange:this.handleChange,children:[Object(S.jsx)("option",{value:"2",children:"Aumentar"}),Object(S.jsx)("option",{value:"1",children:"Restar"})]})}),Object(S.jsx)(N.a,{children:Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"total",id:"total",onChange:this.handleChange,value:a?a.capital_bursatil:""})})]})]}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Razon"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"razon",id:"razon",onChange:this.handleChange,value:a?a.razon:""}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Task ID"}),Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"reference_id",id:"reference_id",onChange:this.handleChange,value:a?a.razons:""})]})}),Object(S.jsxs)(I.a,{children:["insertar"===this.state.tipoModal?Object(S.jsx)("button",{className:"btn btn-success",onClick:function(){return e.peticionPost()},children:"Insertar"}):Object(S.jsx)("button",{className:"btn btn-primary",onClick:function(){return e.peticionPut()},children:"Actualizar"}),Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.modalInsertar()},children:"Cancelar"})]})]}),Object(S.jsxs)(v.a,{isOpen:this.state.modalEliminar,children:[Object(S.jsxs)(k.a,{children:["Est\xe1s seguro que deseas eliminar a la empresa ",a&&a.nombre]}),Object(S.jsxs)(I.a,{children:[Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.peticionDelete()},children:"S\xed"}),Object(S.jsx)("button",{className:"btn btn-secundary",onClick:function(){return e.setState({modalEliminar:!1})},children:"No"})]})]})]})}}]),a}(n.Component),T=a(248),R=a(27),q=a.n(R),G=a(35),$=a.n(G),B="https://api.tookanapp.com/v2/get_job_and_fleet_details",V={"Content-Type":"application/json"},L=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={jobArray:null,data:{id:"",envio:0,distancia:0,tiempo:0},id:0,job_latitude:0,job_longitude:0,job_pickup_latitude:0,job_pickup_longitude:0,job_pickup_address:"",job_address:"",modalInsertar:!1,modalEliminar:!1,fecha:{inicial:"",final:""},form:{id:"",nombre:"",pais:0,razon:"",razons:"",reference_id:"",tipoModal:"",aurest:2,crediwallet:2,wallettotal:0,total:0}},e.peticionPrimera=function(){var t={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",team_id:"449045",date:$()().subtract(1,"days").format("YYYY-MM-DD")};x.a.post(B,t,V).then((function(t){var a,n=q.a.get(t.data,"data.teams.449045.jobs"),c=q.a.map(n,"job_id"),r=q.a.chunk(c,100),i=[],o=Object(T.a)(r);try{for(o.s();!(a=o.n()).done;){var s=a.value,l={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",job_ids:s,include_task_history:0};x.a.post("https://api.tookanapp.com/v2/get_job_details",l,V).then((function(t){var a=q.a.get(t.data,"data");i=q.a.concat(i,a),e.setState({jobArray:i})})),console.log(e.state.jobArray)}}catch(d){o.e(d)}finally{o.f()}}))},e.peticionSegunda=function(){var t=e.state.jobArray,a=q.a.filter(t,{job_status:2}),n=q.a.uniqBy(a,"order_id"),c=new Date;console.log(c.getDate()-1);for(var r=function(t){var a=n[t];console.log(n[t]);var c=String(a.total_distance_travelled);if(console.log(a),"null"===c){var r={template_name:"Order_Details",delivery_latitude:a.job_latitude,delivery_longitude:a.job_longitude,api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",pickup_latitude:a.job_pickup_latitude,pickup_longitude:a.job_pickup_longitude,formula_type:1,map_keys:{map_plan_type:1,google_api_key:"AIzaSyDVkVjap_CH32oy6A3V6T_ewq9jIq8q5eY"}};x.a.post("https://api.tookanapp.com/v2/get_fare_estimate",r,V).then((function(t){console.log(t.data.data.estimated_fare);var n={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",fleet_id:a.fleet_id,amount:t.data.data.estimated_fare-2.5,transaction_type:2,reference_id:String(a.job_id),wallet_type:2,description:"Correccion pedido: #"+a.job_id};x.a.post("https://api.tookanapp.com/v2/fleet/wallet/create_transaction",n,V).then((function(t){console.log(t),e.setState({modalInsertar:!0})}))})).catch((function(e){console.log(e.message)}))}},i=0;i<n.length;i++)r(i)},e.peticionGet=function(){var t={template_name:"Order_Details",delivery_latitude:e.state.job_latitude,delivery_longitude:e.state.job_longitude,api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",pickup_latitude:e.state.job_pickup_latitude,pickup_longitude:e.state.job_pickup_longitude,formula_type:1,map_keys:{map_plan_type:1,google_api_key:"AIzaSyDVkVjap_CH32oy6A3V6T_ewq9jIq8q5eY"}};x.a.post(B,t,V).then((function(t){e.setState({data:{envio:t.data.data.estimated_fare,distancia:t.data.data.distance/1e3,tiempo:t.data.data.time/60}})})).catch((function(e){console.log(e.message)}))},e.peticionPost=Object(f.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return delete e.state.form.id,t.next=3,x.a.post(B,e.state.form).then((function(t){e.modalInsertar(),e.peticionGet()})).catch((function(e){console.log(e.message)}));case 3:case"end":return t.stop()}}),t)}))),e.peticionPut=function(){e.setState({data:{envio:"Cargando...",distancia:"Cargando...",tiempo:"Cargando..."}});var t={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",job_ids:[e.state.id],include_task_history:0};x.a.post("https://api.tookanapp.com/v2/get_job_details",t,V).then((function(t){e.setState({job_latitude:t.data.data[0].job_latitude,job_longitude:t.data.data[0].job_longitude,job_pickup_latitude:t.data.data[0].job_pickup_latitude,job_pickup_longitude:t.data.data[0].job_pickup_longitude,job_pickup_address:t.data.data[0].job_pickup_address,job_address:t.data.data[0].job_address}),e.peticionGet()}))},e.peticionDelete=function(){x.a.delete(B+e.state.form.id).then((function(t){e.setState({modalEliminar:!1}),e.peticionGet()}))},e.modalInsertar=function(){e.setState({modalInsertar:!e.state.modalInsertar})},e.seleccionarEmpresa=function(t){e.setState({tipoModal:"actualizar",form:{id:t.fleet_id,nombre:t.name,pais:"Cargando...",aurest:2,crediwallet:2,wallettotal:"Cargando...",capital_bursatil:t.pais}});var a={api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",fleet_id:t.fleet_id,wallet_type:2,starting_date:"2019-06-21",ending_date:"2023-06-21"};x.a.post("https://api.tookanapp.com/v2/fleet/wallet/read_transaction_history",a,V).then((function(a){if(1===a.data.data.wallet_balance[0].wallet_type)var n=a.data.data.wallet_balance[0].wallet_balance;else n="Cargando...";e.setState({tipoModal:"actualizar",form:{id:t.fleet_id,nombre:t.name,pais:a.data.data.wallet_balance[a.data.data.wallet_balance.length-1].wallet_balance,aurest:2,crediwallet:2,wallettotal:n,capital_bursatil:t.pais}})})).catch((function(e){console.log(e.message)}))},e.handleChangeFecha=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState({fecha:Object(p.a)(Object(p.a)({},e.state.fecha),{},Object(b.a)({},a.target.name,a.target.value))});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState({id:a.target.value});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.form;t.data;return Object(S.jsxs)(F,{title:"Automatizaci\xf3n",children:[Object(S.jsx)("button",{className:"btn btn-success",style:{width:"98%"},onClick:function(){return e.peticionPrimera()},children:"Actualizar"}),Object(S.jsxs)(v.a,{isOpen:this.state.modalInsertar,centered:!0,children:[Object(S.jsx)(y.a,{style:{display:"block"},children:Object(S.jsx)("span",{style:{float:"right"},onClick:function(){return e.modalInsertar()},children:"x"})}),Object(S.jsx)(k.a,{children:Object(S.jsx)("h1",{children:"Actualizado"})}),Object(S.jsx)(I.a,{children:Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.modalInsertar()},children:"Salir"})})]}),Object(S.jsxs)(v.a,{isOpen:this.state.modalEliminar,children:[Object(S.jsxs)(k.a,{children:["Est\xe1s seguro que deseas eliminar a la empresa ",a&&a.nombre]}),Object(S.jsxs)(I.a,{children:[Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.peticionDelete()},children:"S\xed"}),Object(S.jsx)("button",{className:"btn btn-secundary",onClick:function(){return e.setState({modalEliminar:!1})},children:"No"})]})]})]})}}]),a}(n.Component),U=a(17),W=a(497),H=a(160);a(487),a(295);H.a.initializeApp({apiKey:"AIzaSyBoq6dNTx5NeD8vK5diVkxo5aKXpk07gsc",authDomain:"yappareports.firebaseapp.com",databaseURL:"https://yappareports.firebaseio.com",projectId:"yappareports",storageBucket:"yappareports.appspot.com",messagingSenderId:"660964690119",appId:"1:660964690119:web:2136f0e20e1aac24e656e2",measurementId:"G-WWQQKE5Z78"});var K=H.a,J=a(107),Q=a.n(J),X=a(98),Z=a.n(X),ee=a(62),te=a.n(ee),ae=function(e){e.isOpen;var t=e.form,a=e.setModalEliminar;return Object(S.jsxs)(v.a,{isOpen:!1,children:[Object(S.jsxs)(k.a,{children:["Est\xe1s seguro que deseas eliminar a la empresa ",t&&t.nombre]}),Object(S.jsxs)(I.a,{children:[Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){},children:"S\xed"}),Object(S.jsx)("button",{className:"btn btn-secundary",onClick:function(){return a(!1)},children:"No"})]})]})},ne=function(e){var t,a=e.isOpen,n=e.handleChange,c=e.form,r=e.data,i=e.peticionPost,o=e.peticionGet,s=e.setModalInsertar;return Object(S.jsxs)(v.a,{isOpen:a,centered:!0,children:[Object(S.jsx)(y.a,{style:{display:"block"},children:Object(S.jsx)("span",{style:{float:"right"},onClick:function(){return s(!1)},children:"x"})}),Object(S.jsx)(k.a,{children:Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"id",children:"ID"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"id",id:"id",readOnly:!0,onChange:n,value:c?null===c||void 0===c?void 0:c.id:(null===r||void 0===r?void 0:r.length)+1}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Nombre"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"nombre",id:"nombre",readOnly:!0,onChange:n,value:c?null===c||void 0===c?void 0:c.nombre:""}),Object(S.jsx)("br",{}),Object(S.jsxs)(C.a,{children:[Object(S.jsxs)(w.a,{children:[Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Wallet"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"wallettotal",id:"wallettotal",readOnly:!0,onChange:n,value:"Cargando..."!==(null===c||void 0===c?void 0:c.wallettotal)?"$"+(null===c||void 0===c||null===(t=c.wallettotal)||void 0===t?void 0:t.toFixed(2)):null===c||void 0===c?void 0:c.wallettotal})]}),Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Credito"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"pais",id:"pais",readOnly:!0,onChange:n,value:"Cargando..."!==(null===c||void 0===c?void 0:c.pais)?"$"+(null===c||void 0===c?void 0:c.pais.toFixed(2)):null===c||void 0===c?void 0:c.pais})]})]}),Object(S.jsx)("br",{}),Object(S.jsxs)("select",{className:"form-control",name:"crediwallet",id:"crediwallet",onChange:n,children:[Object(S.jsx)("option",{value:"2",children:"Credito"}),Object(S.jsx)("option",{value:"1",children:"Wallet"})]}),Object(S.jsx)("br",{}),Object(S.jsxs)(w.a,{children:[Object(S.jsx)(N.a,{children:Object(S.jsxs)("select",{className:"form-control",name:"aurest",id:"aurest",onChange:n,children:[Object(S.jsx)("option",{value:"2",children:"Aumentar"}),Object(S.jsx)("option",{value:"1",children:"Restar"})]})}),Object(S.jsx)(N.a,{children:Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"total",id:"total",onChange:n,value:c?null===c||void 0===c?void 0:c.capital_bursatil:""})})]})]}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Razon"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"razon",id:"razon",onChange:n,value:c?null===c||void 0===c?void 0:c.razon:""}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Task ID"}),Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"reference_id",id:"reference_id",onChange:n,value:c?null===c||void 0===c?void 0:c.razons:""})]})}),Object(S.jsxs)(I.a,{children:["insertar"===(null===c||void 0===c?void 0:c.tipoModal)?Object(S.jsx)("button",{className:"btn btn-success",onClick:function(){return i()},children:"Insertar"}):Object(S.jsx)("button",{className:"btn btn-primary",onClick:function(){return o()},children:"Actualizar"}),Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return s(!1)},children:"Cancelar"})]})]})},ce=(a(245),te.a.ExcelFile),re=te.a.ExcelFile.ExcelSheet,ie=te.a.ExcelFile.ExcelColumn,oe="https://us-central1-yappareports.cloudfunctions.net/tookanQuery",se={date:"2021-04-17"},le=function(){var e=Object(n.useState)([]),t=Object(U.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)([]),i=Object(U.a)(r,2),o=(i[0],i[1]),s=Object(n.useState)(!0),l=Object(U.a)(s,2),d=l[0],u=l[1],j=Object(n.useState)(!1),b=Object(U.a)(j,2),p=b[0],m=b[1],O=Object(n.useState)(!1),_=Object(U.a)(O,2),g=_[0],v=_[1],y=Object(n.useState)(""),k=Object(U.a)(y,2),C=k[0],I=k[1],z=Object(n.useState)($()().subtract(7,"days")),D=Object(U.a)(z,2),M=D[0],E=D[1],A=Object(n.useState)($()()),P=Object(U.a)(A,2),Y=P[0],T=P[1],R={id:"",nombre:"",pais:0,razon:"",razons:"",reference_id:"",tipoModal:"",aurest:2,crediwallet:2,wallettotal:0,total:0},q=function(){x.a.post(oe,se).then((function(e){c(e.data.data),o(e.data.data)})).catch((function(e){console.log(e.message)}))},G=function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.persist(),R[t.target.name]=t.target.value;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I(t.target.value);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(!0),K.firestore().collection("orders").orderBy("accepted_at").where("migrated","==",!0).startAt($()(M).format("YYYY-MM-DD")).endAt($()(Y).format("YYYY-MM-DD")).get().then((function(e){var t=e.docs.map((function(e){return e.data()}));""!==C&&(t=t.filter((function(e){return e.restaurant_name.toUpperCase().indexOf(C.toUpperCase())>-1||(e.client_first_name+" "+e.client_last_name).toUpperCase().indexOf(C.toUpperCase())>-1}))),c(t),u(!1)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){V()}),[M,Y]),Object(S.jsxs)(F,{title:"Panel",children:[Object(S.jsxs)(w.a,{className:"d-flex py-4 align-items-end",children:[Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{children:"B\xfasqueda"}),Object(S.jsx)("br",{}),Object(S.jsx)("input",{className:"form-control",placeholder:"",onChange:B,onBlur:B})]}),Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Desde"}),Object(S.jsx)(Z.a,{customInput:Object(S.jsx)("input",{className:"form-control"}),selected:M.toDate(),onChange:function(e){return E($()(e))},dateFormat:"dd-MM-yyyy"})]}),Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Hasta"}),Object(S.jsx)(Z.a,{customInput:Object(S.jsx)("input",{className:"form-control"}),selected:Y.toDate(),onChange:function(e){return T($()(e))},dateFormat:"dd-MM-yyyy"})]}),Object(S.jsx)(N.a,{children:Object(S.jsxs)(W.a,{className:"btn btn-primary",onClick:function(){return V()},children:["Filtrar ",Object(S.jsx)("i",{class:"bi bi-filter"})]})}),Object(S.jsx)(N.a,{children:Object(S.jsx)(ce,{filename:"reporte",element:Object(S.jsxs)(W.a,{className:"btn btn-primary",href:"#",children:["Exportar Excel ",Object(S.jsx)("i",{class:"bi bi-download"})]}),children:Object(S.jsxs)(re,{data:a,name:"Reporte",children:[Object(S.jsx)(ie,{label:"Order ID",value:"id"}),Object(S.jsx)(ie,{label:"Tipo",value:"type"}),Object(S.jsx)(ie,{label:"Fecha",value:function(e){return $()(e.accepted_at).format("DD-MM-YYYY")}}),Object(S.jsx)(ie,{label:"Nombre",value:function(e){return e.client_first_name+" "+e.client_last_name}}),Object(S.jsx)(ie,{label:"Mail",value:"client_email"}),Object(S.jsx)(ie,{label:"Venta Total sin descuento",value:"total_price"}),Object(S.jsx)(ie,{label:"Venta total con descuento",value:function(e){return(.965*e.total_price-.35).toFixed(2)}}),Object(S.jsx)(ie,{label:"Descuento",value:function(e){return(3.5*e.total_price/100+.35).toFixed(2)}}),Object(S.jsx)(ie,{label:"Metodo",value:"payment"}),Object(S.jsx)(ie,{label:"Restaurante",value:"restaurant_name"})]})})})]}),Object(S.jsx)(Q.a,{columns:[{name:"Order ID",sortable:!0,selector:"id"},{name:"Tipo",sortable:!0,selector:"type"},{name:"Fecha",sortable:!0,cell:function(e){return Object(S.jsx)("div",{children:$()(e.accepted_at).format("DD-MM-YYYY")})}},{name:"Nombre",sortable:!0,cell:function(e){return Object(S.jsxs)("div",{children:[e.client_first_name," ",e.client_last_name]})}},{name:"Venta Total sin descuento",sortable:!0,cell:function(e){return Object(S.jsxs)("div",{children:["$",e.total_price]})}},{name:"Venta total c. descuento",sortable:!0,cell:function(e){return Object(S.jsxs)("div",{children:["$",(.965*e.total_price-.35).toFixed(2)]})}},{name:"Descuento",sortable:!0,cell:function(e){return Object(S.jsxs)("div",{children:["$",(3.5*e.total_price/100+.35).toFixed(2)]})}},{name:"Metodo",sortable:!0,selector:"payment"},{name:"Mail",sortable:!0,selector:"client_email"},{name:"Comercio",sortable:!0,right:!0,selector:"restaurant_name"}],data:a,pagination:!0,responsive:!0,progressPending:d}),Object(S.jsx)(ne,{isOpen:!!g,handleChange:G,form:R,data:a,peticionPost:function(){delete R.id,x.a.post(oe,R).then((function(){v(!1),q()})).catch((function(e){console.log(e.message)}))},peticionGet:q,setModalInsertar:v}),Object(S.jsx)(ae,{isOpen:!!p,form:R,setModalEliminar:m})]})},de="https://api.tookanapp.com/v2/send_notification",ue={"Content-Type":"application/json"},je=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={jobArray:null,id:0,total:0,job_latitude:0,job_longitude:0,job_pickup_latitude:0,job_pickup_longitude:0,job_pickup_address:"",job_address:"",modalInsertar:!1,modalEliminar:!1,form:{id:"",nombre:"",pais:0,razon:"",razons:"",reference_id:"",tipoModal:"",aurest:2,crediwallet:2,wallettotal:0,total:0}},e.noti=function(){x.a.post(de,{api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",fleet_ids:[636771,1060358],message:"Probando propina Jose Manuel, Rosa"},ue).then((function(e){console.log(e.data)}))},e.peticionDelete=function(){x.a.delete(de+e.state.form.id).then((function(t){e.setState({modalEliminar:!1}),e.peticionGet()}))},e.modalInsertar=function(){e.setState({modalInsertar:!e.state.modalInsertar})},e.handleChangeFecha=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState({fecha:Object(p.a)(Object(p.a)({},e.state.fecha),{},Object(b.a)({},a.target.name,a.target.value))});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(){var t=Object(f.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.persist(),t.next=3,e.setState({total:a.target.value});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.form;t.data;return Object(S.jsxs)(F,{title:"Notificaciones",children:[Object(S.jsxs)(C.a,{children:[Object(S.jsx)("input",{className:"form-control",type:"text",name:"total",id:"total",placeholder:"Texto",onChange:this.handleChange}),Object(S.jsx)("br",{}),Object(S.jsx)("button",{className:"btn btn-success",style:{width:"100%"},onClick:function(){return e.noti()},children:"Notificacion"})]}),Object(S.jsxs)(v.a,{isOpen:this.state.modalInsertar,centered:!0,children:[Object(S.jsx)(y.a,{style:{display:"block"},children:Object(S.jsx)("span",{style:{float:"right"},onClick:function(){return e.modalInsertar()},children:"x"})}),Object(S.jsx)(k.a,{children:Object(S.jsx)("h1",{children:"Actualizado"})}),Object(S.jsx)(I.a,{children:Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.modalInsertar()},children:"Salir"})})]}),Object(S.jsxs)(v.a,{isOpen:this.state.modalEliminar,children:[Object(S.jsxs)(k.a,{children:["Est\xe1s seguro que deseas eliminar a la empresa ",a&&a.nombre]}),Object(S.jsxs)(I.a,{children:[Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.peticionDelete()},children:"S\xed"}),Object(S.jsx)("button",{className:"btn btn-secundary",onClick:function(){return e.setState({modalEliminar:!1})},children:"No"})]})]})]})}}]),a}(n.Component),be=K.firestore(),pe=be.collection("orders"),me=function(){var e=c.a.useState([]),t=Object(U.a)(e,2),a=t[0],n=(t[1],function(){var e=Object(f.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.limit(10).get();case 2:return t=e.sent,a=be.batch(),t.forEach((function(e){var t,n,c=e.data();console.info({documentData:c}),1===(null===(t=c)||void 0===t||null===(n=t.orders)||void 0===n?void 0:n.length)&&(c=Object(p.a)(Object(p.a)({},c.orders[0]),{},{migrated:!0})),a.update(e.ref,c)})),e.next=7,a.commit();case 7:return e.abrupt("return");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return Object(S.jsxs)("div",{className:"App",children:[Object(S.jsx)("button",{onClick:function(){pe.where("migrated","==",!1).limit(100).get().then((function(e){e.docs.map(function(){var e=Object(f.a)(h.a.mark((function e(t){var a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.id,n=t.data(),console.info("MIGRATED ".concat(a,": "),1===n.orders.length),1!==n.orders.length){e.next=6;break}return e.next=6,pe.doc(a).set(Object(p.a)(Object(p.a)({},n.orders[0]),{},{migrated:!0}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))},children:"Importar"}),Object(S.jsx)("br",{}),Object(S.jsx)("br",{}),Object(S.jsx)("button",{onClick:n,children:"BATCH"}),Object(S.jsx)("br",{}),Object(S.jsx)("br",{}),"COUNT: ",a.count,Object(S.jsx)("br",{}),a.map((function(e){return Object(S.jsx)("div",{children:e},e)}))]})},he=a(99),fe=a(8),Oe=a(253);x.a.defaults.headers.common["Content-Type"]="application/json",x.a.interceptors.request.use((function(e){return e.data.api_key="56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",e}));var xe="https://api.tookanapp.com/v2",_e={get_job_and_fleet_details:function(e){return x.a.post("".concat(xe,"/get_job_and_fleet_details"),e)},get_job_details:function(e){return x.a.post("".concat(xe,"/get_job_details"),e).then((function(e){return e.data}))},view_fleet_profile:function(e){return x.a.post("".concat(xe,"/view_fleet_profile"),{api_key:"56616583f2464d185d5a773c4345254315edc6f922df783f5c1a06",fleet_id:e})},create_transaction:function(e){return x.a.post("".concat(xe,"/fleet/wallet/create_transaction"),e)},send_notification:function(e){return x.a.post("".concat(xe,"/send_notification"),e)}},ge=Object(p.a)({},_e),ve=function(e){var t=e.noti,a=e.isOpen,n=e.setModalEliminar,c=e.setIsLoading,r=e.total,i=function(){var e=Object(f.a)(h.a.mark((function e(){var a,i,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),(a=[]).push(t.id),i={fleet_ids:a,message:"Hola "+t.nombre+", hemos realizado una transferencia a tu cuenta por $"+r},e.next=6,ge.send_notification(i);case 6:o=e.sent,console.info({notification:o}),n((function(e){return!e})),c(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(S.jsxs)(v.a,{isOpen:a,centered:!0,children:[Object(S.jsx)(k.a,{children:Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsxs)("label",{htmlFor:"nombre",children:["Monto depositado a ",t.nombre+" "," "]}),Object(S.jsxs)("label",{htmlFor:"nombr",children:[" - TOTAL: "," "+t.total]})]})}),Object(S.jsxs)(I.a,{children:[Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return n(!1)},children:"Salir"}),Object(S.jsx)("button",{className:"btn btn-success",onClick:i,children:"Notificacion"})]})]})},ye=function(e){var t=e.data,a=e.form,n=e.isOpen,c=e.setModalInsertar,r=e.setIsLoading,i=e.handleChange,o=e.tipoModal,s=function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.next=3,ge.create_transaction({fleet_id:a.id,amount:a.total,transaction_type:a.aurest,reference_id:a.reference_id,wallet_type:a.crediwallet,description:a.razon});case 3:c((function(e){return!e})),r(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete a.id,r(!0),e.next=4,ge.get_job_and_fleet_details(a);case 4:r(!1),c((function(e){return!e}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(S.jsxs)(v.a,{isOpen:n,centered:!0,children:[Object(S.jsx)(y.a,{style:{display:"block"},children:Object(S.jsx)("span",{style:{float:"right"},onClick:function(){return c((function(e){return!e}))},children:"x"})}),Object(S.jsx)(k.a,{children:Object(S.jsxs)("div",{className:"form-group",children:[Object(S.jsx)("label",{htmlFor:"id",children:"ID"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"id",id:"id",readOnly:!0,onChange:i,value:a?a.id:t.length+1}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Nombre"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"nombre",id:"nombre",readOnly:!0,onChange:i,value:a?a.nombre:""}),Object(S.jsx)("br",{}),Object(S.jsxs)(C.a,{children:[Object(S.jsxs)(w.a,{children:[Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Wallet"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"wallettotal",id:"wallettotal",readOnly:!0,onChange:i,value:"Cargando..."!==a.wallettotal?"$"+a.wallettotal.toFixed(2):a.wallettotal})]}),Object(S.jsxs)(N.a,{children:[Object(S.jsx)("label",{htmlFor:"nombre",children:"Credito"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"pais",id:"pais",readOnly:!0,onChange:i,value:"Cargando..."!==a.pais?"$"+a.pais.toFixed(2):a.pais})]})]}),Object(S.jsx)("br",{}),Object(S.jsxs)("select",{className:"form-control",name:"crediwallet",id:"crediwallet",onChange:i,children:[Object(S.jsx)("option",{value:"2",children:"Credito"}),Object(S.jsx)("option",{value:"1",children:"Wallet"})]}),Object(S.jsx)("br",{}),Object(S.jsxs)(w.a,{children:[Object(S.jsx)(N.a,{children:Object(S.jsxs)("select",{className:"form-control",name:"aurest",id:"aurest",onChange:i,children:[Object(S.jsx)("option",{value:"2",children:"Aumentar"}),Object(S.jsx)("option",{value:"1",children:"Restar"})]})}),Object(S.jsx)(N.a,{children:Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"total",id:"total",onChange:i,value:a?a.capital_bursatil:""})})]})]}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Razon"}),Object(S.jsx)("input",{className:"form-control",type:"text",name:"razon",id:"razon",onChange:i,value:a?a.razon:""}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{htmlFor:"nombre",children:"Task ID"}),Object(S.jsx)("input",{className:"form-control",type:"number",inputmode:"numeric",name:"reference_id",id:"reference_id",onChange:i,value:a?a.razons:""})]})}),Object(S.jsxs)(I.a,{children:["insertar"===o?Object(S.jsx)("button",{className:"btn btn-success",onClick:l,children:"Insertar"}):Object(S.jsx)("button",{className:"btn btn-primary",onClick:s,children:"Actualizar"}),Object(S.jsx)("button",{className:"btn btn-danger",onClick:function(){return c((function(e){return!e}))},children:"Cancelar"})]})]})},ke=te.a.ExcelFile,Ce=te.a.ExcelFile.ExcelSheet,we=te.a.ExcelFile.ExcelColumn,Ne=function(e){return Object(S.jsx)("div",{children:Object(S.jsxs)(fe.p.Option,Object(p.a)(Object(p.a)({},e),{},{children:[Object(S.jsx)("input",{type:"checkbox",checked:e.isSelected,onChange:function(){return null}})," ",Object(S.jsx)("label",{children:e.label})]}))})},Ie=function(){var e=c.a.useState(!1),t=Object(U.a)(e,2),a=t[0],r=t[1],i=c.a.useState([]),o=Object(U.a)(i,2),s=o[0],l=o[1],d=c.a.useState([]),u=Object(U.a)(d,2),j=(u[0],u[1]),m=c.a.useState(0),O=Object(U.a)(m,2),x=O[0],_=O[1],g=c.a.useState(!1),v=Object(U.a)(g,2),y=v[0],k=v[1],C=c.a.useState(!1),I=Object(U.a)(C,2),z=I[0],D=I[1],M=c.a.useState(new Date),E=Object(U.a)(M,2),A=E[0],P=E[1],Y=c.a.useState(""),T=Object(U.a)(Y,2),R=T[0],G=T[1],B=c.a.useState([]),V=Object(U.a)(B,2),L=V[0],H=V[1],K=c.a.useState([]),J=Object(U.a)(K,2),X=J[0],ee=J[1],te=c.a.useState({id:"",nombre:"",pais:0,razon:"",razons:"",reference_id:"",tipoModal:"",aurest:2,crediwallet:2,wallettotal:0,total:0}),ae=Object(U.a)(te,2),ne=ae[0],ce=ae[1],re=c.a.useState({id:0,nombre:"",total:0}),ie=Object(U.a)(re,2),oe=ie[0],se=ie[1],le=c.a.useState(""),de=Object(U.a)(le,2),ue=de[0],je=(de[1],function(){var e=Object(f.a)(h.a.mark((function e(){var t,a,n,c,i,o,s,d,u,b,m,f,O,x;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.next=3,ge.get_job_and_fleet_details({team_id:"449045",date:A?$()(A).format("YYYY-MM-DD"):$()().format("YYYY-MM-DD"),ignore_fleets:"0",search_string:R||""});case 3:return t=e.sent,a=q.a.get(t.data,"data.teams.449045.jobs"),n=q.a.map(a,"job_id"),c=q.a.chunk(n,100),e.next=9,Promise.all(c.map((function(e){return ge.get_job_details({job_ids:e,include_task_history:0})})));case 9:i=e.sent,o=q.a.flatten(i.map((function(e){return e.data}))),s=q.a.filter(o,{job_status:2}),d=q.a.filter(s,"order_id"),u=q.a.filter(d,{job_type:1}),b=u.filter((function(e){return"Items"!==e.custom_field[11].label})),m=b.filter((function(e){return console.info("FILTRO",e.job_pickup_name,L),!(L.length>0)||!!L.find((function(t){return t.value===e.job_pickup_name}))})),f=m.map((function(e){var t=a.find((function(t){return t.job_id===e.job_id})).fleet_name;return Object(p.a)(Object(p.a)({},e),{},{fleet_name:t})})),console.info({resultadoWithFleetName:f}),O=Object(he.a)(new Set(f.map((function(e){return{value:e.job_pickup_name,label:e.job_pickup_name}})))),x=q.a.uniqBy(O,(function(e){return e.label})),ee(q.a.uniq(x)),H(q.a.uniq(x)),l(f),j(f),r(!1);case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),be=function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.persist(),ce(Object(p.a)(Object(p.a)({},ne),{},Object(b.a)({},t.target.name,t.target.value)));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(f.a)(h.a.mark((function e(t){var a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={fleet_id:t.fleet_id,amount:0,transaction_type:2,reference_id:String(t.job_id),wallet_type:2,description:"Propina del pedido: "+t.job_id},r(!0),e.next=4,ge.create_transaction(a);case 4:return e.sent,e.next=7,ge.view_fleet_profile(t.fleet_id);case 7:n=e.sent,l((function(e){return console.info({data:e,order:t}),e.filter((function(e){return e.job_id!==t.job_id}))})),_(0),se({id:t.fleet_id,nombre:n.data.data.fleet_details[0].first_name+" "+n.data.data.fleet_details[0].last_name,total:(t.custom_field[11].data-3.5*t.custom_field[11].data/100).toFixed(2)}),D((function(e){return!e})),r(!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){a||je()}),[]);return Object(S.jsxs)(F,{title:"Propinas",children:[Object(S.jsxs)(w.a,{className:"d-flex py-4 align-items-end",children:[Object(S.jsxs)(N.a,{children:["Fecha:",Object(S.jsx)("br",{}),Object(S.jsx)(Z.a,{customInput:Object(S.jsx)("input",{className:"form-control"}),selected:A,onChange:function(e){return P(e)}})]}),Object(S.jsxs)(N.a,{children:["Buscar:",Object(S.jsx)("br",{}),Object(S.jsx)("input",{className:"form-control",placeholder:"Buscar...",onChange:function(e){G(e.target.value)}})]}),Object(S.jsxs)(N.a,{children:["Comercios:",Object(S.jsx)("br",{}),Object(S.jsx)(Oe.a,{options:X,isMulti:!0,closeMenuOnSelect:!1,hideSelectedOptions:!1,components:{Option:Ne},onChange:function(e){H(e)},allowSelectAll:!0,value:L})]}),Object(S.jsx)(N.a,{children:Object(S.jsxs)(W.a,{className:"btn btn-primary",onClick:function(){return je()},children:["Filtrar ",Object(S.jsx)("i",{class:"bi bi-filter"})]})}),Object(S.jsx)(N.a,{children:Object(S.jsx)(ke,{filename:"reporte",element:Object(S.jsxs)(W.a,{className:"btn btn-primary",href:"#",children:["Exportar Excel ",Object(S.jsx)("i",{class:"bi bi-download"})]}),children:Object(S.jsxs)(Ce,{data:s,name:"Reporte",children:[Object(S.jsx)(we,{label:"Job ID",value:"job_id"}),Object(S.jsx)(we,{label:"Nombre",value:function(e){return e.custom_field[0].data?e.custom_field[0].data:e.custom_field[1].data}}),Object(S.jsx)(we,{label:"Venta Total sin descuento",value:function(e){return"Items"!==e.custom_field[11].label?"$"+e.custom_field[11].data:"SIN PROPINA"}}),Object(S.jsx)(we,{label:"Venta total con descuento",value:function(e){return"Items"!==e.custom_field[11].label?"$"+(3.5*e.custom_field[11].data/100).toFixed(2):"SIN PROPINA"}}),Object(S.jsx)(we,{label:"Recibe",value:function(e){return"Items"!==e.custom_field[11].label?"$"+(e.custom_field[11].data-3.5*e.custom_field[11].data/100).toFixed(2):"SIN PROPINA"}}),Object(S.jsx)(we,{label:"Motorizado",value:"fleet_name"})]})})})]}),Object(S.jsx)(Q.a,{columns:[{name:"Order ID",sortable:!0,cell:function(e){return e.job_id}},{name:"Nombre",sortable:!0,cell:function(e){return Object(S.jsx)("div",{children:e.job_pickup_name})}},{name:"Propina",sortable:!0,cell:function(e){return Object(S.jsx)("div",{children:"Items"!==e.custom_field[11].label?"$"+e.custom_field[11].data:"SIN PROPINA"})}},{name:"3.5%",sortable:!0,cell:function(e){return Object(S.jsx)("div",{children:"Items"!==e.custom_field[11].label?"$"+(3.5*e.custom_field[11].data/100).toFixed(2):"SIN PROPINA"})}},{name:"Recibe",sortable:!0,cell:function(e){return Object(S.jsx)("div",{children:"Items"!==e.custom_field[11].label?"$"+(e.custom_field[11].data-3.5*e.custom_field[11].data/100).toFixed(2):"SIN PROPINA"})}},{name:"Motorizado",sortable:!0,cell:function(e){return Object(S.jsx)("div",{children:Object(S.jsx)("button",{className:"btn btn-success",onClick:function(){pe(e)},children:e.fleet_name})})}}],data:s,pagination:!0,responsive:!0,progressPending:a}),Object(S.jsx)(ye,{data:s,form:ne,isOpen:y,setModalInsertar:k,handleChange:be,tipoModal:ue,setIsLoading:r}),Object(S.jsx)(ve,{noti:oe,isOpen:z,setModalEliminar:D,setIsLoading:r,total:x})]})},Se=function(e){e.children,e.title;var t=c.a.useState(!1),a=Object(U.a)(t,2),n=a[0],r=a[1],i=c.a.useState(""),o=Object(U.a)(i,2),s=o[0],l=o[1],d=c.a.useState(""),u=Object(U.a)(d,2),j=u[0],b=u[1],p=c.a.useState(null),m=Object(U.a)(p,2),h=m[0],f=m[1];return Object(S.jsx)("div",{className:"wrapper fadeInDown",children:Object(S.jsxs)("div",{id:"formContent",children:[Object(S.jsx)("div",{className:"fadeIn first",children:Object(S.jsx)("img",{src:"/reactpaya/logo.png",alt:"logo",style:{width:"200px"}})}),Object(S.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=K.firestore().collection("admins");r(!0),f(null),t.where("user","==",s).where("password","==",j).get().then((function(e){r(!1),e.empty?f("Usuario o contrase\xf1a incorrectos"):(localStorage.setItem("authenticated",!0),window.location.href="/payatookan")})).catch((function(e){console.log({error:e}),r(!1),f("Usuario o contrase\xf1a incorrectos")}))},children:[Object(S.jsx)("input",{type:"text",id:"login",className:"fadeIn second",name:"login",placeholder:"Usuario",onChange:function(e){return l(e.target.value)}}),Object(S.jsx)("input",{type:"password",id:"password",className:"fadeIn third",name:"login",placeholder:"Contrase\xf1a",onChange:function(e){return b(e.target.value)}}),Object(S.jsx)("div",{children:h&&Object(S.jsx)("p",{className:"text-danger",children:h})}),n&&Object(S.jsx)("div",{class:"spinner-border m-4",role:"status",children:Object(S.jsx)("span",{class:"sr-only",children:"Ingresando..."})}),Object(S.jsxs)("div",{className:"m-4",children:[Object(S.jsx)("input",{type:"submit",className:"fadeIn fourth",value:"Ingresar"}),Object(S.jsx)("br",{})]})]})]})})},Fe=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(S.jsxs)(u.a,{children:[Object(S.jsx)(j.b,{path:"/login",exact:!0,children:Object(S.jsx)(Se,{})}),Object(S.jsx)(j.b,{path:"/payatookan",exact:!0,children:Object(S.jsx)(E,{})}),Object(S.jsx)(j.b,{path:"/payatookan/envios/",children:Object(S.jsx)(Y,{})}),Object(S.jsx)(j.b,{path:"/payatookan/propina/",children:Object(S.jsx)(Ie,{})}),Object(S.jsx)(j.b,{path:"/payatookan/auto/",children:Object(S.jsx)(L,{})}),Object(S.jsx)(j.b,{path:"/payatookan/panel/",children:Object(S.jsx)(le,{})}),Object(S.jsx)(j.b,{path:"/payatookan/noti/",children:Object(S.jsx)(je,{})}),Object(S.jsx)(j.b,{path:"/payatookan/import/",children:Object(S.jsx)(me,{})}),Object(S.jsx)(j.b,{exact:!0,path:"/",children:Object(S.jsx)(j.a,{to:"/login"})})]})}}]),a}(n.Component),ze=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(S.jsx)(Fe,{})}}]),a}(n.Component),De=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,499)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),r(e),i(e)}))};i.a.render(Object(S.jsx)(c.a.StrictMode,{children:Object(S.jsx)(ze,{})}),document.getElementById("root")),De()},58:function(e,t,a){}},[[483,1,2]]]);
//# sourceMappingURL=main.e67f0933.chunk.js.map